<!DOCTYPE html>
<html>
	<head>
		<title>My Home</title>
		<meta name='viewport' content='initial-scale=1.0, width=device-width'/>

		<style>
			body
			{
				background: #C0A166;
			}
			a
			{
				text-decoration: none;
			}
			canvas
			{
				background-color: rgba(255, 255, 255, 0.3);
				border: 1px solid rgba(255, 255, 255, 0.3);
				margin: 5px
			}
			
			#tooltip
			{
				background-color: rgba(255, 255, 255, 0.6);
				visibility: collapse;
				position: absolute;
				padding: 3px;
			}

			/* title */
			.title
			{
				display: table;
				margin-bottom: 10px;
			}
			.title img
			{
				display: table-cell;
				width: 32px;
				height: 32px;
				padding: 10px;
			}
			.title h1
			{
				display: table-cell;
				vertical-align: middle;
			}
			h2.title
			{
				margin: 0px 0px 10px 15px;
			}

			/* button */
			.button
			{
				padding: 3px 5px;
				color: black;
				background: #ddd;
				border-color: #fff #888 #888 #fff;
				border-width: 2px;
				border-style: solid;
				margin: 3px;
			}
			.buttonContainer
			{
				padding: 3px;
				margin: 5px;
			}
			.red
			{
				background: #d00;
				border-color: #f00 #800 #800 #f00;
			}
			.green
			{
				background: #0d0;
				border-color: #0f0 #080 #080 #0f0;
			}
			.login
			{
				font-size: large;
				font-weight: bold;
				padding: 5px 7px;
				margin: 7px 5px;
			}

			/* system list */
			ul.system, .settings
			{
				list-style-type: none;
				padding: 0px 5px;
			}
			.system h2
			{
				display: inline-block;
				width: 150px;
				margin: 5px 0px;
			}

			/* settings */
			.settings h3
			{
				display: inline-block;
				width: 200px;
				margin: 3px 0px;
			}
			.settings details
			{
				margin: 3px 0px;
			}
		</style>

		<script type='text/javascript'>
			function submitForm(formId) {
				document.getElementById(formId).submit()
			}

			function addItem(sender) {
				var parent = sender.parentElement.parentElement
				var index = Array.prototype.indexOf.call(parent.children, sender.parentElement)
				var newItem = parent.children[index - 1].cloneNode(true)
				parent.insertBefore(newItem, parent.children[index])
			}

			function removeItem(sender) {
				var parent = sender.parentElement.parentElement
				parent.parentElement.removeChild(parent)
			}

			function addText(sender, formId, inputName) {
				var form = document.getElementById(formId)
				var element = form.elements[inputName]
				element.value += sender.text
			}

			function removeText(formId, inputName, count) {
				var form = document.getElementById(formId)
				var element = form.elements[inputName]
				element.value = element.value.substr(0, element.value.length - count)
			}
			
			function drawLineChart(canvasId, values, names, drawValues, drawAxis) {
				var axisStyle = '#000000';
				var axisGuideStyle = 'rgba(255, 255, 255, 0.3)';
				var chartStyle = '#0000cc';
				var textStyle = '#666666';
				if (!Array.isArray(values) || values.length == 0)
					return
					
				var minValue = values[0], maxValue = values[0];
				for (i = 1; i < values.length; i++) {
					minValue = Math.min(minValue, values[i]);
					maxValue = Math.max(maxValue, values[i]);
				}
				
				var canvas = document.getElementById(canvasId);
				var context = canvas.getContext("2d");
				var withEps = (canvas.width - 20) / (values.length - 1);
				var heightEps = (canvas.height - 40) / Math.max(maxValue - minValue, 1);
				var start = {x: 10, y: canvas.height - 20};
				
				if (drawAxis) {					
					var maxValueWidth = context.measureText(maxValue).width;
					var textHeight = parseInt(context.font);
					// draw X and Y axis
					context.beginPath();
					context.moveTo(maxValueWidth + 10, 10);
					context.lineTo(maxValueWidth + 10, canvas.height - 10);
					context.moveTo(maxValueWidth + 10, canvas.height - 10);
					context.lineTo(canvas.width - 10, canvas.height - 10);
					context.strokeStyle = axisStyle;
					context.stroke();
					
					for (i = minValue; i <= maxValue; i++) {
						if (i % Math.max(Math.round(textHeight / heightEps), 1) != 0)
							continue;
						// draw horizontal line
						context.beginPath();
						context.strokeStyle = axisGuideStyle;
						context.moveTo(maxValueWidth + 10 + 1, start.y - (i - minValue) * heightEps);
						context.lineTo(canvas.width - 10 + 1, start.y - (i - minValue) * heightEps);
						context.stroke();
						// draw value
						var textWidth = context.measureText(i).width;
						context.strokeStyle = textStyle;
						context.strokeText(i, maxValueWidth + 5 - textWidth, start.y - (i - minValue) * heightEps + textHeight / 2);
					}
					
					withEps = (canvas.width - 20 - maxValueWidth - 15) / (values.length - 1);
					start = {x: 10 + maxValueWidth + 10, y: canvas.height - 20};
				}
				
				context.beginPath();
				context.strokeStyle = chartStyle;
				context.fillStyle = chartStyle;
				context.moveTo(start.x, start.y - (values[0] - minValue) * heightEps);
				context.fillRect(start.x - 2, start.y - (values[0] - minValue) * heightEps - 2, 4, 4);
				for (i = 1; i < values.length; i++) {
					var pos = {x: start.x + i * withEps, y: start.y - (values[i] - minValue) * heightEps};
					context.lineTo(pos.x, pos.y);
					context.fillRect(pos.x - 2, pos.y - 2, 4, 4);
				}
				context.stroke();
				
				if (drawValues) {
					context.strokeStyle = textStyle;
					for (i = 0; i < values.length; i++) {
						if (i > 0 && values[i] == values[i - 1])
							continue;
						var pos = {x: start.x + i * withEps, y: start.y - (values[i] - minValue) * heightEps};
						var textWidth = context.measureText(values[i]).width;
						var textHeight = parseInt(context.font);
						if (i > 0 && values[i - 1] > values[i]) textHeight *= -1;
						else if (i > 0 && values[i - 1] == values[i] && i % 2 == 0) textHeight *= -1;
						context.strokeText(values[i], pos.x - textWidth / 2, pos.y + 4 - textHeight);
					}
				}
				
				if (Array.isArray(names)) {
					var tooltip = document.getElementById("tooltip");
					canvas.onmousemove = function(e) {
						tooltip.style.visibility = "collapse";
						var canvasPosX = e.clientX - canvas.getBoundingClientRect().left;
						var canvasPosY = (e.clientY - canvas.getBoundingClientRect().top);
						var idx = Math.round((canvasPosX - start.x) / withEps);
						if (idx < 0 || idx >= values.length)
							return;
						var chartY = start.y - (values[idx] - minValue) * heightEps;
						if (Math.abs(chartY - canvasPosY) > 5)
							return;
							
						tooltip.style.left = e.pageX + "px";
						tooltip.style.top = (e.pageY + 20) + "px";
						tooltip.style.visibility = "visible";
						tooltip.innerHTML = names[idx] + ": " + values[idx];
					};
				}
			}
		</script>
	</head>

	<body>

		<div class='title'>
			<img src='/favicon.ico'/>
			<h1>My Home</h1>
		</div>
		
		<div id='tooltip'>
		</div>

		<content/>

	</body>
</html>